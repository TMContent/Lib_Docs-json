{
  "id": "b815f0fa-861c-46a1-bfe4-41f8f5eaff8b",
  "checksum": "26f8ff4e21a5143cfb4ced3754cdd94b495955d3",
  "words": {
    "this": [
      "p"
    ],
    "article": [
      "p",
      "h3",
      "pre",
      "h3",
      "h3"
    ],
    "shows": [
      "p"
    ],
    "an": [
      "p"
    ],
    "script": [
      "p",
      "h3"
    ],
    "example": [
      "p"
    ],
    "on": [
      "p",
      "pre",
      "pre"
    ],
    "how": [
      "p"
    ],
    "a": [
      "p",
      "h3",
      "h3",
      "title"
    ],
    "custom": [
      "p"
    ],
    "cwe": [
      "p",
      "p",
      "pre",
      "pre",
      "h3",
      "pre",
      "pre",
      "title"
    ],
    "library": [
      "p",
      "h3",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "title"
    ],
    "was": [
      "p"
    ],
    "created": [
      "p"
    ],
    "using": [
      "p",
      "p"
    ],
    "team": [
      "p",
      "p",
      "a",
      "h3",
      "h3",
      "pre"
    ],
    "mentor's": [
      "p"
    ],
    "webservices": [
      "p"
    ],
    "api": [
      "p"
    ],
    "as": [
      "p",
      "pre",
      "pre"
    ],
    "source": [
      "p"
    ],
    "material": [
      "p"
    ],
    "the": [
      "p",
      "pre",
      "pre"
    ],
    "html": [
      "p"
    ],
    "files": [
      "p"
    ],
    "distributed": [
      "p"
    ],
    "with": [
      "p",
      "p",
      "h3",
      "pre"
    ],
    "checkmarx": [
      "p",
      "h3",
      "pre",
      "pre",
      "title"
    ],
    "requirements": [
      "p",
      "strong"
    ],
    "windows": [
      "p"
    ],
    "net": [
      "p"
    ],
    "40,": [
      "p"
    ],
    "o2": [
      "p",
      "a"
    ],
    "platform": [
      "p",
      "a"
    ],
    "mentor": [
      "p",
      "a",
      "h3",
      "h3",
      "pre"
    ],
    "unit": [
      "p",
      "a"
    ],
    "tests": [
      "p",
      "a"
    ],
    "github": [
      "p"
    ],
    "repository": [
      "p"
    ],
    "connect": [
      "h3",
      "h3"
    ],
    "to": [
      "h3",
      "h3",
      "h3",
      "h3"
    ],
    "instance": [
      "h3",
      "h3"
    ],
    "of": [
      "h3",
      "h3"
    ],
    "and": [
      "h3",
      "h3",
      "h3",
      "h3"
    ],
    "login": [
      "h3",
      "h3"
    ],
    "var": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "teammentor": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "new": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "api_team": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "mentor_webservices\"http://localhost:3186/\");": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "teammentorlogin(\"admin\",": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "adminpwd;\nreturn": [
      "pre",
      "pre"
    ],
    "teammentorloggedin();\n//using": [
      "pre"
    ],
    "securityinnovationteam": [
      "pre"
    ],
    "mentor\n//o2file:..\\team": [
      "pre"
    ],
    "mentor-unittests\\apis\\api_team": [
      "pre"
    ],
    "mentor_webservicescs": [
      "pre"
    ],
    "teammentorloggedin();": [
      "pre"
    ],
    "create": [
      "h3",
      "h3"
    ],
    "adminpwd;\nvar": [
      "pre",
      "pre"
    ],
    "teammentorlibrary(\"checkmarx\");\nreturn": [
      "pre",
      "pre"
    ],
    "create/get": [
      "h3",
      "h3"
    ],
    "view": [
      "h3",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "libraryview(\"cwe": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "data\";": [
      "pre",
      "pre"
    ],
    "adminpwd;": [
      "pre",
      "pre",
      "pre"
    ],
    "teammentorlibrary(\"checkmarx\");": [
      "pre",
      "pre"
    ],
    "data\";\nreturn": [
      "pre"
    ],
    "viewarticle(\"test": [
      "pre"
    ],
    "3\";": [
      "pre"
    ],
    "metadata": [
      "h3"
    ],
    "title": [
      "pre",
      "pre",
      "pre"
    ],
    "\"xyz": [
      "pre"
    ],
    "topic\"\nvar": [
      "pre"
    ],
    "content": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "h3"
    ],
    "\"h1>article": [
      "pre"
    ],
    "xyz/h1>with": [
      "pre"
    ],
    "some": [
      "pre"
    ],
    "here\"\nvar": [
      "pre"
    ],
    "technology": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "\"any\"\nvar": [
      "pre"
    ],
    "phase": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "\"design\"\nvar": [
      "pre"
    ],
    "type": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "\"principle\"\nvar": [
      "pre"
    ],
    "category": [
      "pre",
      "pre",
      "pre"
    ],
    "\"appsec\"\n\nreturn": [
      "pre"
    ],
    "viewadd_article(title,": [
      "pre",
      "pre"
    ],
    "category;": [
      "pre",
      "pre"
    ],
    "add": [
      "h3",
      "h3"
    ],
    "one": [
      "h3"
    ],
    "mentor_webservices\"http://localhost.:3186/\");": [
      "pre"
    ],
    "teammentorlibrary(\"checkmarx\").delete().library(\"checkmarx\");\nvar": [
      "pre",
      "pre"
    ],
    "data\";\n\n//load": [
      "pre",
      "pre"
    ],
    "datavar": [
      "pre",
      "pre"
    ],
    "checkmark_xmldumps": [
      "pre",
      "pre"
    ],
    "\"_checkmark_xmldumps\"tempdir(false);": [
      "pre",
      "pre"
    ],
    "xroot": [
      "pre",
      "pre"
    ],
    "\"cwedata\"o2cache[xelement](()=]": [
      "pre",
      "pre"
    ],
    "checkmark_xmldumpspathcombine(\"cwe.xml\").xroot());\n\nvar": [
      "pre",
      "pre"
    ],
    "cweentry": [
      "pre",
      "pre"
    ],
    "xrootelements().second();\n\n//add": [
      "pre"
    ],
    "entry": [
      "pre",
      "pre"
    ],
    "tm": [
      "pre",
      "pre",
      "h3"
    ],
    "articlevar": [
      "pre"
    ],
    "cweid": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "cweentryelements().first().value();\nvar": [
      "pre"
    ],
    "cwehtml": [
      "pre",
      "pre"
    ],
    "cweentryelements().second().value();": [
      "pre"
    ],
    "cweid\nvar": [
      "pre"
    ],
    "cwehtml\nvar": [
      "pre"
    ],
    "\"any\"": [
      "pre",
      "pre"
    ],
    "\"report\"": [
      "pre",
      "pre"
    ],
    "\"chexkmarx\"\nvar": [
      "pre"
    ],
    "\"cwe\"\n\nreturn": [
      "pre"
    ],
    "all": [
      "h3"
    ],
    "articles": [
      "h3"
    ],
    "mentor_webservicestmsite);": [
      "pre"
    ],
    "count": [
      "pre",
      "pre"
    ],
    "0\n\nvar": [
      "pre"
    ],
    "cweentries": [
      "pre"
    ],
    "xrootelements().tolist();\nforeach(var": [
      "pre"
    ],
    "in": [
      "pre",
      "pre"
    ],
    "cweentries\n{\n\t//add": [
      "pre"
    ],
    "article\tvar": [
      "pre"
    ],
    "cweentryelements().first().value();\n\tvar": [
      "pre"
    ],
    "cweentryelements().second().value();\n\tvar": [
      "pre"
    ],
    "\"cwe\"\n\tvar": [
      "pre"
    ],
    "\"checkmarx": [
      "pre"
    ],
    "db\"\n\tvar": [
      "pre"
    ],
    "cweid\n\tvar": [
      "pre"
    ],
    "cwehtml\n\tif": [
      "pre"
    ],
    "cweid==\"-1\")": [
      "pre"
    ],
    "//": [
      "pre"
    ],
    "handle": [
      "pre"
    ],
    "special": [
      "pre"
    ],
    "case": [
      "pre",
      "title"
    ],
    "where": [
      "pre",
      "pre",
      "pre"
    ],
    "they": [
      "pre"
    ],
    "embeded": [
      "pre"
    ],
    "css": [
      "pre"
    ],
    "item": [
      "pre"
    ],
    "id": [
      "pre"
    ],
    "-1\t{\n\t\ttype": [
      "pre"
    ],
    "\"css\"\n\t\ttitle": [
      "pre"
    ],
    "\"maincss\";\n\t\tcwehtml": [
      "pre"
    ],
    "cwehtmlsubstring_after(\"[style]\").trim();\n\t}\n\tview.add_article(title,": [
      "pre"
    ],
    "category;\n\tif": [
      "pre"
    ],
    "count++.mod0(20))\n\t\t\"[{0}": [
      "pre"
    ],
    "/": [
      "pre"
    ],
    "{1}\".debug(count,": [
      "pre"
    ],
    "cweentriessize());\n}\nreturn": [
      "pre"
    ],
    "\"created": [
      "pre"
    ],
    "{0}": [
      "pre"
    ],
    "articles\"format(count).info();": [
      "pre"
    ],
    "mass": [
      "h3"
    ],
    "change": [
      "h3"
    ],
    "checkmark": [
      "h3"
    ],
    "table": [
      "h3"
    ],
    "point": [
      "h3"
    ],
    "into": [
      "h3"
    ],
    "vistadb": [
      "pre",
      "pre"
    ],
    "api_vistadb);\nvar": [
      "pre"
    ],
    "serverip": [
      "pre"
    ],
    "\"xxxx.xx.xx\";\nvar": [
      "pre"
    ],
    "htmlredirecttemplate": [
      "pre"
    ],
    "\"&lt\"": [
      "pre"
    ],
    "+": [
      "pre"
    ],
    "@\"html&gt<meta": [
      "pre"
    ],
    "http-equiv=\"\"": [
      "pre"
    ],
    "refresh\"\"=\"\"": [
      "pre"
    ],
    "content=\"\"": [
      "pre"
    ],
    "0=\"\"": [
      "pre"
    ],
    "url=\"http//{0}/html/{1}&quot;&quot;\">\";\n\n\"starting": [
      "pre"
    ],
    "update\"info();\nvar": [
      "pre"
    ],
    "rows": [
      "pre",
      "pre"
    ],
    "vistadbtable(\"cwe\").datatable().rows;\nvar": [
      "pre"
    ],
    "0\nforeach(datarow": [
      "pre"
    ],
    "row": [
      "pre"
    ],
    "{\tvar": [
      "pre"
    ],
    "rowitemarray[0].str().info();": [
      "pre"
    ],
    "htmlredirect": [
      "pre"
    ],
    "htmlredirecttemplateformat(serverip,": [
      "pre"
    ],
    "cweid;\n\tvistadb.executescalar(\"update": [
      "pre"
    ],
    "set": [
      "pre"
    ],
    "description": [
      "pre",
      "pre"
    ],
    "'{1}'": [
      "pre"
    ],
    "='{0}'\"format(cweid,": [
      "pre"
    ],
    "htmlredirect);": [
      "pre"
    ],
    "vistadbexecutescalar(\"select": [
      "pre"
    ],
    "from": [
      "pre",
      "title"
    ],
    "='{0}'\"format(cweid));\n\tif": [
      "pre"
    ],
    "count++.mod0(25))\n\t\t\"[{0}/{1}\".debug(count,": [
      "pre"
    ],
    "rowssize());": [
      "pre"
    ],
    "}\"update": [
      "pre"
    ],
    "complete\"info();\nreturn": [
      "pre"
    ],
    "study": [
      "title"
    ],
    "-": [
      "title"
    ],
    "creating": [
      "title"
    ],
    "data": [
      "title"
    ]
  },
  "tags": {
    "p": [
      "This article shows an script example on how a custom CWE Library was created using TEAM Mentor's WebServices API, using as source material the CWE HTML files distributed with Checkmarx",
      "Requirements: Windows with .NET 4.0,  O2 Platform,  TEAM Mentor Unit Tests GitHub Repository"
    ],
    "strong": [
      "Requirements"
    ],
    "a": [
      "O2 Platform",
      "TEAM Mentor Unit Tests"
    ],
    "h3": [
      "Connect to a instance of TEAM Mentor and and login",
      "Connect to a instance of TEAM Mentor and and login",
      "Create Checkmarx library",
      "Create/Get View:",
      "Create/Get Article",
      "Create Article with Metadata",
      "Add one article",
      "Add all articles",
      "Script to mass change Checkmark CWE table to point into TM content:"
    ],
    "pre": [
      "var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nreturn teamMentor.loggedIn();\n//using SecurityInnovation.TEAM Mentor;\n//O2File:..\\TEAM Mentor-UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs",
      "var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nreturn teamMentor.loggedIn();",
      "var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nvar library = teamMentor.library(\"Checkmarx\");\nreturn library;",
      "var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nvar library = teamMentor.library(\"Checkmarx\");\nreturn library.view(\"CWE Data\");",
      "teamMentor.login(\"admin\", adminPwd); \nvar library = teamMentor.library(\"Checkmarx\"); \nvar view = library.view(\"CWE Data\");\nreturn view.article(\"test article 3\");",
      "var library = teamMentor.library(\"Checkmarx\"); \n\nvar view = library.view(\"CWE Data\");\n \nvar title = \"XYZ topic\";\nvar content = \"<h1>Article on XYZ</h1>With some content here\";\nvar technology  = \"Any\";\nvar phase = \"Design\";\nvar type = \"Principle\";\nvar category = \"AppSec\";\n\nreturn view.add_Article(title, content, technology, phase, type, category);",
      "var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost.:3186/\");  \nteamMentor.login(\"admin\", adminPwd); \n\nvar library = teamMentor.library(\"Checkmarx\").delete().library(\"Checkmarx\");\nvar view = library.view(\"CWE Data\");\n\n//load Checkmarx CWE data\nvar checkMark_XmlDumps = \"_CheckMark_XmlDumps\".tempDir(false); \nvar xRoot = \"cweData\".o2Cache[XElement](()=] checkMark_XmlDumps.pathCombine(\"CWE.xml\").xRoot());\n\nvar cweEntry = xRoot.elements().second();\n\n//add entry as TM article\nvar cweId = cweEntry.elements().first().value();\nvar cweHtml = cweEntry.elements().second().value();\n \n \nvar title = cweId;\nvar content = cweHtml;\nvar technology  = \"Any\"; \nvar phase = \"Report\"; \nvar type = \"Chexkmarx\";\nvar category  = \"CWE\";\n\nreturn view.add_Article(title, content, technology, phase, type, category);",
      "var teamMentor = new API_TEAM Mentor_WebServices(tmSite);  \nteamMentor.login(\"admin\", adminPwd); \n\nvar library = teamMentor.library(\"Checkmarx\").delete().library(\"Checkmarx\");\nvar view = library.view(\"CWE Data\");\n\n//load Checkmarx CWE data\nvar checkMark_XmlDumps = \"_CheckMark_XmlDumps\".tempDir(false); \nvar xRoot = \"cweData\".o2Cache[XElement](()=] checkMark_XmlDumps.pathCombine(\"CWE.xml\").xRoot());\n\nvar count = 0;\n\nvar cweEntries = xRoot.elements().toList();\nforeach(var cweEntry in cweEntries)\n{\n\t//add entry as TM article\n\tvar cweId = cweEntry.elements().first().value();\n\tvar cweHtml = cweEntry.elements().second().value();\n\tvar technology  = \"Any\"; \n\tvar phase = \"Report\"; \n\tvar type = \"CWE\";\n\tvar category  = \"CheckMarx DB\";\n\tvar title = cweId;\n\tvar content = cweHtml;\n\tif (cweId==\"-1\") \t// handle special case where they embeded the css on the item with id -1\n\t{\n\t\ttype = \"css\";\n\t\ttitle = \"main.css\";\n\t\tcweHtml =  cweHtml.subString_After(\"[style]\").trim();\n\t}\n\tview.add_Article(title, content, technology, phase, type, category);\n\tif (count++.mod0(20))\n\t\t\"[{0} / {1}]\".debug(count, cweEntries.size());\n}\nreturn \"Created {0} TEAM Mentor articles\".format(count).info();",
      "var vistaDb = new API_VistaDB();\nvar serverIp = \"xx.xx.xx.xx\";\nvar htmlRedirectTemplate = \"&lt;\" + @\"html&gt;<meta http-equiv=\"\" refresh\"\"=\"\" content=\"\" 0;=\"\" url=\"http://{0}/html/{1}&quot;&quot;\">\";\n\n\"starting update\".info();\nvar rows = vistaDb.table(\"CWE\").dataTable().Rows;\nvar count = 0;\nforeach(DataRow row in rows) \n{\n\tvar cweId = row.ItemArray[0].str().info(); \n\tvar htmlRedirect = htmlRedirectTemplate.format(serverIp, cweId);\n\tvistaDb.executeScalar(\"UPDATE CWE SET Description = '{1}' where CweId ='{0}'\".format(cweId, htmlRedirect)); \n\tvistaDb.executeScalar(\"select Description from CWE where CweId ='{0}'\".format(cweId));\n\tif (count++.mod0(25))\n\t\t\"[{0}/{1}\".debug(count, rows.size());\n }\n\"update complete\".info();\nreturn vistaDb;"
    ]
  },
  "links": [
    {
      "href": "https://github.com/o2platform/O2_Install ",
      "text": " O2 Platform"
    },
    {
      "href": "https://github.com/TEAM Mentor/UnitTests ",
      "text": " TEAM Mentor Unit Tests"
    }
  ],
  "html": "<p>This article shows an script example on how a custom CWE Library was created using TEAM Mentor's WebServices API, using as source material the CWE HTML files distributed with Checkmarx\n</p><p>\n<strong>Requirements</strong>: Windows with .NET 4.0, <a href=\"https://github.com/o2platform/O2_Install \"> O2 Platform</a>, <a href=\"https://github.com/TEAM Mentor/UnitTests \"> TEAM Mentor Unit Tests</a> GitHub Repository\n</p><h3>Connect to a instance of TEAM Mentor and and login</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nreturn teamMentor.loggedIn();\n//using SecurityInnovation.TEAM Mentor;\n//O2File:..\\TEAM Mentor-UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs\n</pre><h3>Connect to a instance of TEAM Mentor and and login</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nreturn teamMentor.loggedIn();\n</pre><h3>Create Checkmarx library</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nvar library = teamMentor.library(\"Checkmarx\");\nreturn library;\n</pre><h3>Create/Get View:</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:3186/\"); \nteamMentor.login(\"admin\", adminPwd);\nvar library = teamMentor.library(\"Checkmarx\");\nreturn library.view(\"CWE Data\");\n</pre><h3>Create/Get Article</h3><pre>teamMentor.login(\"admin\", adminPwd); \nvar library = teamMentor.library(\"Checkmarx\"); \nvar view = library.view(\"CWE Data\");\nreturn view.article(\"test article 3\");\n</pre><h3>Create Article with Metadata</h3><pre>var library = teamMentor.library(\"Checkmarx\"); \n\nvar view = library.view(\"CWE Data\");\n \nvar title = \"XYZ topic\";\nvar content = \"&lt;h1&gt;Article on XYZ&lt;/h1&gt;With some content here\";\nvar technology  = \"Any\";\nvar phase = \"Design\";\nvar type = \"Principle\";\nvar category = \"AppSec\";\n\nreturn view.add_Article(title, content, technology, phase, type, category);\n</pre><h3>Add one article</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost.:3186/\");  \nteamMentor.login(\"admin\", adminPwd); \n\nvar library = teamMentor.library(\"Checkmarx\").delete().library(\"Checkmarx\");\nvar view = library.view(\"CWE Data\");\n\n//load Checkmarx CWE data\nvar checkMark_XmlDumps = \"_CheckMark_XmlDumps\".tempDir(false); \nvar xRoot = \"cweData\".o2Cache[XElement](()=] checkMark_XmlDumps.pathCombine(\"CWE.xml\").xRoot());\n\nvar cweEntry = xRoot.elements().second();\n\n//add entry as TM article\nvar cweId = cweEntry.elements().first().value();\nvar cweHtml = cweEntry.elements().second().value();\n \n \nvar title = cweId;\nvar content = cweHtml;\nvar technology  = \"Any\"; \nvar phase = \"Report\"; \nvar type = \"Chexkmarx\";\nvar category  = \"CWE\";\n\nreturn view.add_Article(title, content, technology, phase, type, category);\n</pre>\n\n<h3>Add all articles</h3><pre>var teamMentor = new API_TEAM Mentor_WebServices(tmSite);  \nteamMentor.login(\"admin\", adminPwd); \n\nvar library = teamMentor.library(\"Checkmarx\").delete().library(\"Checkmarx\");\nvar view = library.view(\"CWE Data\");\n\n//load Checkmarx CWE data\nvar checkMark_XmlDumps = \"_CheckMark_XmlDumps\".tempDir(false); \nvar xRoot = \"cweData\".o2Cache[XElement](()=] checkMark_XmlDumps.pathCombine(\"CWE.xml\").xRoot());\n\nvar count = 0;\n\nvar cweEntries = xRoot.elements().toList();\nforeach(var cweEntry in cweEntries)\n{\n\t//add entry as TM article\n\tvar cweId = cweEntry.elements().first().value();\n\tvar cweHtml = cweEntry.elements().second().value();\n\tvar technology  = \"Any\"; \n\tvar phase = \"Report\"; \n\tvar type = \"CWE\";\n\tvar category  = \"CheckMarx DB\";\n\tvar title = cweId;\n\tvar content = cweHtml;\n\tif (cweId==\"-1\") \t// handle special case where they embeded the css on the item with id -1\n\t{\n\t\ttype = \"css\";\n\t\ttitle = \"main.css\";\n\t\tcweHtml =  cweHtml.subString_After(\"[style]\").trim();\n\t}\n\tview.add_Article(title, content, technology, phase, type, category);\n\tif (count++.mod0(20))\n\t\t\"[{0} / {1}]\".debug(count, cweEntries.size());\n}\nreturn \"Created {0} TEAM Mentor articles\".format(count).info();\n\n</pre><h3>Script to mass change Checkmark CWE table to point into TM content:</h3><pre>var vistaDb = new API_VistaDB();\nvar serverIp = \"xx.xx.xx.xx\";\nvar htmlRedirectTemplate = \"&amp;lt;\" + @\"html&amp;gt;&lt;meta http-equiv=\"\" refresh\"\"=\"\" content=\"\" 0;=\"\" url=\"http://{0}/html/{1}&amp;quot;&amp;quot;\"&gt;\";\n\n\"starting update\".info();\nvar rows = vistaDb.table(\"CWE\").dataTable().Rows;\nvar count = 0;\nforeach(DataRow row in rows) \n{\n\tvar cweId = row.ItemArray[0].str().info(); \n\tvar htmlRedirect = htmlRedirectTemplate.format(serverIp, cweId);\n\tvistaDb.executeScalar(\"UPDATE CWE SET Description = '{1}' where CweId ='{0}'\".format(cweId, htmlRedirect)); \n\tvistaDb.executeScalar(\"select Description from CWE where CweId ='{0}'\".format(cweId));\n\tif (count++.mod0(25))\n\t\t\"[{0}/{1}\".debug(count, rows.size());\n }\n\"update complete\".info();\nreturn vistaDb;\n</pre>"
}