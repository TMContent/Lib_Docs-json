{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "1da6050d-3521-4c13-93c2-49ce93b8583f"
        ],
        "Library_Id": [
          "eb39d862-f752-4d1c-ab6e-14ed697397c0"
        ],
        "Title": [
          "Case Study - Direct XML File Manipulation to Fix Double Encoding Issue"
        ],
        "Category": [
          ""
        ],
        "Phase": [
          ""
        ],
        "Technology": [
          ""
        ],
        "Type": [
          ""
        ],
        "DirectLink": [
          "Case Study - Direct XML File Manipulation to Fix Double Encoding Issue"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "wikitext"
        },
        "Data": [
          "This Script shows how the Article's XML file can be edited directly (useful for large/batch changes/fixes).\n\n\nIn this case there was a double encoding issue on the Article's Schema update from version 3.0 to 3.1\n\n\n===Fixing the Double Encode issue in one file===\n{{{\nvar topPanel = panel.clear().add_Panel();\nvar sourceFiles = @\"C:\\_WorkDir\\TEAM Mentor\\TM - Libraries\\SI_Library\\Java\\Java\";\n\nvar target = @\"...\\TEAM Mentor\\TM - Libraries\\SI_Library\\Java\\Java\\Checklist Item\\c88e1b49-357d-4202-aafc-86ce0de485bd.xml\";\n\ntopPanel.add_SourceCodeViewer()\n\t\t.open(target);\n\t\t\t\t\t\t\nvar tmArticle = target.load&lt; TeamMentor_Article&gt;();\ntmArticle.Content.Data.Value = tmArticle.Content.Data.Value.replace(\"&\",\"&\");\ntmArticle.saveAs(target);\n \nreturn target;\n//using SecurityInnovation.TEAM Mentor.WebClient\n//O2File:...\\Web Applications\\TEAM Mentor.CoreLib\\TM_AppCode\\Schemas\\TeamMentor_Article.cs\n}}}\n\n===Fixing the double encoding for all files===\n{{{\nvar topPanel = panel.clear().add_Panel();\nvar sourceFiles = @\"C:\\_WorkDir\\TEAM Mentor\\TM - Libraries\\SI_Library\";\n\nforeach (var file in sourceFiles.files(\"*.xml\",true))\n{\t\n\tif(file.fileName_WithoutExtension().isGuid().isFalse())\n\t\tcontinue;\n\tvar tmArticle = file.load&lt; TeamMentor_Article&gt;();\n\tif (tmArticle.Content.Data.Value.contains(\"&\"))\n\t{\n\t\t\"fixing: {0}\".debug(file);\t\n\t\ttmArticle.Content.Data.Value = tmArticle.Content.Data.Value.replace(\"&\",\"&\");\n\t\ttmArticle.saveAs(file);\n\t}\n\telse\n\t\t\"Skipping: {0}\".info(file);\t\n  } \n\n//using SecurityInnovation.TEAM Mentor.WebClient\n//O2File:...\\Web Applications\\TEAM Mentor.CoreLib\\TM_AppCode\\Schemas\\TeamMentor_Article.cs\n}}}\n\n===Upgrading 1 file from 3.0 schema to 3.1===\n{{{\nvar target = @\"...\\TEAM Mentor\\TM - Libraries\\SI_Library\\Java\\Java\\Code Example\\18ac74df-602b-4a58-8998-52f638f3a045.xml\";\nreturn target.load&lt; Guidance_Item_Import&gt;().transform().saveAs(target);\n}}}\n\n"
        ]
      }
    ]
  }
}