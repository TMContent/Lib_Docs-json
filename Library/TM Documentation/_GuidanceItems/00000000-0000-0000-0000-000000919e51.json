{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-377927615",
      "Content_Hash": "-379906202"
    },
    "Metadata": [
      {
        "Id": [
          "00000000-0000-0000-0000-000000919e51"
        ],
        "Library_Id": [
          "eb39d862-f752-4d1c-ab6e-14ed697397c0"
        ],
        "Title": [
          "Script - Creating TM Library based on CWE files"
        ],
        "Category": [
          " "
        ],
        "Phase": [
          "Draft"
        ],
        "Technology": [
          "TEAM Mentor"
        ],
        "Type": [
          "Script"
        ],
        "DirectLink": [
          ""
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "\n<div style=\"font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal\">\n<br>\n</div>\n<div style=\"font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal\">\n<br>\n</div>\n<h3>File 1</h3>\n<div style=\"font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal\">\n<br>\n</div>\n<div>\n<div><font face=\"Arial, Verdana\" size=\"2\">var xmlFile = @&quot;C:\\O2\\_tempDir\\2-23-2012\\tmp26D7_cwec_v2.1.xml\\cwec_v2.1.xml&quot;;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">var xmlData = Weakness_Catalog.Load(xmlFile);&nbsp;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">var targetFile = @&quot;C:\\O2\\_tempDir\\2-28-2012\\cweData.xml&quot;;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">var cweData= new CWE_Data();</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">var maxItems = 5000;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">foreach(var weakness in xmlData.Weaknesses.Weakness)</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">{</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var cweWeakness = new CWE_Weakness();</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Content = weakness.Description.str();</font></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"><font face=\"Arial, Verdana\" size=\"2\"></font></span></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>if (weakness.Applicable_Platforms.isNull() || weakness.Applicable_Platforms.Languages.isNull())<span class=\"x_Apple-tab-span\" style=\"white-space:pre\">\n</span></font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Technology = &quot;NA&quot;;<span class=\"x_Apple-tab-span\" style=\"white-space:pre\">\n</span></font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>else</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>{&nbsp;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>//return weakness;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var languages = weakness.Applicable_Platforms.Languages;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>if (languages.Language_Class.size() &gt;0)</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Technology = languages.Language_Class[0].Language_Class_Description;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>else</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Technology = languages.Language[0].Language_Name;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>}</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>//cweWeakness.Phase = weakness.Causal_Nature;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>//if (cweWeakness.Phase.inValid())</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>//return weakness;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Title = &quot;CWE:{0} - {1}&quot;.format(weakness.ID, weakness.Name);</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>&nbsp;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Phase = (weakness.Time_of_Introduction.isNull())</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>? &quot;&quot;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>: weakness.Time_of_Introduction.Introductory_Phase.toList().join(&quot;,&quot;);</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>//&quot;phase: {0}&quot;.info(cweWeakness.Phase);<span class=\"x_Apple-tab-span\" style=\"white-space:pre\">\n</span></font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Type = weakness.Status;</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweWeakness.Category = &quot;CWE&quot;;</font></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"><font face=\"Arial, Verdana\" size=\"2\"></font></span></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>cweData.Weaknesses.Add(cweWeakness);</font></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"><font face=\"Arial, Verdana\" size=\"2\"></font></span></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">}</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">cweData.saveAs(targetFile);</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">return cweData.Weaknesses.size();</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">//O2File:CWE_Data.cs</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">//O2File:cwe_schema_v5.1.cs</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">//O2Ref:O2_Misc_Microsoft_MPL_Libs.dll</font></div>\n</div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<h2><font face=\"Arial, Verdana\" size=\"2\">File 2</font></h2>\n<div><font face=\"Arial, Verdana\" size=\"2\"><br>\n</font></div>\n<div><font face=\"Arial, Verdana\" size=\"2\">\n<div>var topPanel = panel.clear().add_Panel(); &nbsp;&nbsp;</div>\n<div>var tmSite= &quot;http://localhost.:12348&quot;;</div>\n<div>//tmSite = &quot;http://localhost.:12347&quot;;</div>\n<div>//tmSite = &quot;http://localhost.:3186&quot;; &nbsp;&nbsp;</div>\n<div>tmSite = &quot;http://50.19.221.68:92&quot;;</div>\n<div>var libraryName = &quot;CWE Library&quot;;</div>\n<div><br>\n</div>\n<div>var tmWebServices = new API_TEAM Mentor_WebServices(tmSite); &nbsp; &nbsp; &nbsp;</div>\n<div><br>\n</div>\n<div>tmWebServices.login(&quot;admin&quot;,&quot;!!tmbeta&quot;).str();</div>\n<div>&nbsp; &nbsp;</div>\n<div>var library = tmWebServices.library(libraryName)</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>.delete()</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>.library(libraryName);&nbsp;</div>\n<div>&nbsp;</div>\n<div>var targetFile = @&quot;C:\\O2\\_tempDir\\2-28-2012\\cweData.xml&quot;; &nbsp;</div>\n<div>var cweData = targetFile.load&lt;CWE_Data&gt;();</div>\n<div>&nbsp;</div>\n<div>var folderName = &quot;Weakness Folder&quot;;&nbsp;</div>\n<div>var viewName = &quot;Weakness&quot;; &nbsp;</div>\n<div><br>\n</div>\n<div>var view = library.folder(folderName)</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>&nbsp;<span class=\"x_Apple-tab-span\" style=\"white-space:pre\">\n</span>&nbsp;.view(viewName); &nbsp;</div>\n<div>&nbsp;</div>\n<div>var max = 1000; &nbsp;</div>\n<div>var itemsAddded = 0;</div>\n<div>var o2Timer = new O2Timer(&quot;created {0} in &quot;.format(max)).start();&nbsp;</div>\n<div><br>\n</div>\n<div>foreach(var weakness in cweData.Weaknesses)</div>\n<div>{ <span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var title = weakness.Title; &nbsp;&nbsp;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var content = weakness.Content;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var technology = weakness.Technology;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var phase = weakness.Phase;&nbsp;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var type = weakness.Type; &nbsp;&nbsp;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>var category = weakness.Category; &nbsp;&nbsp;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>view.add_Article(title, content, technology, phase, type, category);</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span></div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>if (itemsAddded&#43;&#43; % 10 == 0)&nbsp;</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>&quot;[{0}/{1}] - {2}&quot;.info(itemsAddded, cweData.Weaknesses.size(), title);</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>if (itemsAddded &gt; max)</div>\n<div><span class=\"x_Apple-tab-span\" style=\"white-space:pre\"></span>break;</div>\n<div>}</div>\n<div>&nbsp;o2Timer.stop();</div>\n<div>return view.articles();</div>\n<div>&nbsp;</div>\n<div>//O2File:CWE_Data.cs &nbsp;</div>\n<div>//O2File:API_TEAM Mentor_WebServices.cs</div>\n<div>//using SecurityInnovation.TEAM Mentor</div>\n<div><br>\n</div>\n<div>//O2Ref:System.Web.Services.dll</div>\n<div>//O2Ref:O2_Misc_Microsoft_MPL_Libs.dll</div>\n<div><br>\n</div>\n<div>//O2Tag_DontAddExtraO2Files</div>\n</font></div>\n<div style=\"font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal\">\n<br>\n</div>\n"
        ]
      }
    ]
  }
}