{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "4f236f52-24f7-46a0-a8bd-09789baa8a43"
        ],
        "Library_Id": [
          "eb39d862-f752-4d1c-ab6e-14ed697397c0"
        ],
        "Title": [
          "How to - Upload Files or Images"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "wikitext"
        },
        "Data": [
          "This article shows how to programatically uploading files or images to an TEAM Mentor instance via its WebServices\n\n**Requirements**: Windows with .NET 4.0, [[https://github.com/o2platform/O2_Install | O2 Platform]], [[https://github.com/TEAM Mentor/UnitTests | TEAM Mentor Unit Tests]] GitHub Repository\n\n===Config target TM instance===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost\",3187);\nreturn teamMentor.ping(); \n\n//using SecurityInnovation.TEAM Mentor\n//O2File:...l\\_TEAM Mentor\\TEAM Mentor-UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs\n//O2Ref:System.Web.Services.dll\n}}}\n\n===Login ===\n{{{\nvar adminPwd = \"*****\";\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost\",3187);\nteamMentor.login(\"admin\",adminPwd);\nreturn teamMentor.loggedIn();\n}}}\n\n===Get Upload Token===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost\",3187);\nteamMentor.login(\"admin\",adminPwd);\nvar uploadToken = teamMentor.webServices.GetUploadToken();\nreturn uploadToken.str();\n}}}\n\n===Upload/create a text file===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd);\n\nvar uploadToken = teamMentor.webServices.GetUploadToken();\nvar targetFile = \"filename.txt\";\nvar fileContents = \"This is the file contents\";\n\nvar requestParams = \"/Aspx_Pages/File_Upload.ashx?uploadToken={0}&qqfile={1}\".format(uploadToken, targetFile);\nvar uploadHandler = teamMentor.WebSite_Url.append(requestParams);\n\nreturn uploadHandler.POST(fileContents);\n}}}\n\n===Uploading an Image===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n\nvar uploadToken = teamMentor.webServices.GetUploadToken(); \nvar targetFile = \"O2_Logo.gif\";\nvar fileContents = targetFile.local().fileContents_AsByteArray();\n\nvar requestParams = \"/Aspx_Pages/File_Upload.ashx?uploadToken={0}&qqfile={1}\".format(uploadToken, targetFile);\nvar uploadHandler = teamMentor.WebSite_Url.append(requestParams);\n\nreturn uploadHandler.POST(fileContents);\n\nreturn uploadToken.str();\n}}}\n\n===Simpler version of upload file===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n\nvar targetFile = \"O2_Logo.gif\";\nvar fileContents = targetFile.local().fileContents_AsByteArray();\n\t\t\t\nreturn teamMentor.uploadFile(targetFile, fileContents);\n}}}\n\n===Upload files that can then be retrieved via urls===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n \nvar filename = \"O2_Logo.gif\";\nvar fileContents = filename.local().fileContents_AsByteArray();\t\t\t\nvar libraryId = \"daa1ebc4-d488-46ba-81cf-32e280b5d885\".guid();\n\nreturn teamMentor.webServices.Upload_File_To_Library(libraryId ,filename , fileContents );\n}}}\n\n===Upload to a specific directory===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n \nvar filename = \"O2_Logo.gif\";\nvar fileContents = filename.local().fileContents_AsByteArray();\t\t\t\n\nvar library = teamMentor.library(\"OWASP\");\n\nteamMentor.webServices.Upload_File_To_Library(library.Id ,filename , fileContents );\n\nvar imageUrl = teamMentor.WebSite_Url.append(\"/Image/{0}/{1}\".format(library.Id, filename));\n}}}\n\n===Uploading an Image and viewing it===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n \nvar filename = \"O2_Logo.gif\";\nvar fileContents = filename.local().fileContents_AsByteArray();\t\t\t\nvar libraryId = \"daa1ebc4-d488-46ba-81cf-32e280b5d885\".guid();\n\nteamMentor.webServices.Upload_File_To_Library(libraryId ,filename , fileContents );\n\nvar imageUrl = teamMentor.WebSite_Url.append(\"/Image/{0}/{1}\".format(libraryId, filename));\npanel.clear().add_WebBrowser_Control().open(imageUrl.str());\n\nreturn imageUrl;\n}}}\n\n===Uploading an image from the Clipboard===\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"localhost.\",3187);\nteamMentor.login(\"admin\",adminPwd); \n \nvar tmpFolder= \"_tmpImages\".tempDir();\n\nvar image = tmpFolder.saveImageFromClipboardToFolder(); \n\nvar filename = image.fileName();\nvar fileContents = image.fileContents_AsByteArray();\t\t\t\n\nvar library = teamMentor.library(\"OWASP\");\n\nteamMentor.webServices.Upload_File_To_Library(library.Id ,filename , fileContents );\n\nvar imageUrl = teamMentor.WebSite_Url.append(\"/Image/{0}/{1}\".format(library.Id, filename));\npanel.clear().add_WebBrowser_Control().open(imageUrl.str());\n}}}\n"
        ]
      }
    ]
  }
}