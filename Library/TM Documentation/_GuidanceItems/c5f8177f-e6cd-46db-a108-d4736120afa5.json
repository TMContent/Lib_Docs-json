{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "c5f8177f-e6cd-46db-a108-d4736120afa5"
        ],
        "Library_Id": [
          "eb39d862-f752-4d1c-ab6e-14ed697397c0"
        ],
        "Title": [
          "Case Study - Creating a CWE Library from CWE raw XML"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "wikitext"
        },
        "Data": [
          "After  we have a normalized CWE XML file lets create the TEAM Mentor project\n\n\n**Logging in into teamMentor:**\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:12115\");\n\nteamMentor.login(\"editor\",editorPwd).str();\nreturn teamMentor.isLoggedIn();\n//using SecurityInnovation.TEAM Mentor \n//O2File:...\\TM_UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs\n//O2Ref:System.Web.Services.dll\n}}}\n\n**Get Current User roles:**\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://127.0.0.1:12115\"); \n\nteamMentor.login(\"editor\",editorPwd).str();\nreturn teamMentor.currentUser_Roles();\nget Current Libraries\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://127.0.0.1:12115\"); \nteamMentor.login(\"editor\",editorPwd).str();\n\nreturn teamMentor.libraries();\n}}}\n\n**Create/Get CWE Library**\n{{{\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://127.0.0.1:12115\"); \nteamMentor.login(\"editor\",editorPwd).str();\n\nvar cweLibrary = teamMentor.library(\"CWE\");\n\nreturn cweLibrary;\nGet -> Delete -> Create CWE library\nvar cweLibrary = teamMentor.library(\"CWE\")\n\t\t\t\t\t\t   .delete()\n\t\t\t\t\t\t   .library(\"CWE\");\n\nreturn cweLibrary;\nCreate View:\nvar cweLibrary = teamMentor.library(\"CWE\").delete().library(\"CWE\");\nvar cweWeakness = cweLibrary.add_View(\"Weaknesses\");\nreturn cweWeakness;\n}}}\n\n**Loading CWE Data (from XML file)**\n{{{\nvar editorPwd = \"123qwe\";\n\nvar targetDir = \"_CWE_Data\".tempDir(false);\nvar mappedXml = targetDir.pathCombine(\"Cwe_data.xml\");\nvar cweData = mappedXml.load<CWE_Data>();\n\n\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:12115\");\nteamMentor.login(\"editor\",editorPwd).str();\n\n//using SecurityInnovation.TEAM Mentor \n//O2File:...\\TM_UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs\n//O2File:CWE_Data.cs\n//O2Ref:System.Web.Services.dll\n}}}\n\n**Creating 10 articles in Weaknesses View**\n{{{\n\nvar cweData = mappedXml.load<CWE_Data>();\n\nvar teamMentor = new API_TEAM Mentor_WebServices(\"http://localhost:12115\");\nteamMentor.login(\"editor\",editorPwd).str();\n\nvar tmLibrary = teamMentor.library(\"CWE\").delete().library(\"CWE\");\nvar tmView = tmLibrary.add_View(\"Weaknesses\");\n\nforeach(var weakness in cweData.Weaknesses.Take(10))\n{\n\ttmView.add_Article(weakness.Title, weakness.Content);\n}\nreturn \"done\";\ntesting populating metadata fields and viewing TM site in browser window\nforeach(var weakness in cweData.Weaknesses.Take(10))\n{\n\ttmView.add_Article(weakness.Title,weakness.Content, \"1\",\"2\",\"3\",\"4\");\n}\npanel.clear().add_WebBrowser_Control().open(tmSite);\n}}}\n\n**Populating metadata**\n{{{\nforeach(var weakness in cweData.Weaknesses.Take(10))\n{\n\ttmView.add_Article(weakness.Title,weakness.Content, weakness.Technology,weakness.Phase, weakness.Type, weakness.Category);\n}\n\n**Adding all articles**\n{{{\nvar tmLibrary = teamMentor.library(\"CWE\").delete().library(\"CWE\");\nvar tmView = tmLibrary.add_View(\"Weaknesses\");\nvar itemsProcessed = 0;\nforeach(var weakness in cweData.Weaknesses)\n{\n\ttmView.add_Article(weakness.Title,weakness.Content, weakness.Technology,weakness.Phase, weakness.Type, weakness.Category);\n\tif (itemsProcessed++.mod0(30))\n\t\t\"[{0}/{1}]\".info(itemsProcessed, cweData.Weaknesses.size()); \n}\n}}}\n\n**Creating a Folder mapped by Phase: **\n\nStart by creating a filtered view of the data:\n\n{{{\nvar tmLibrary = teamMentor.library(\"CWE\").delete().library(\"CWE\");\nvar weakness_By_Phase = new Dictionary<string,List<CWE_Weakness>>();\nforeach(var weakness in cweData.Weaknesses)\n{\n\tforeach(var phase in weakness.Phase.split(\",\"))\n\t\tweakness_By_Phase.add(phase.trim(), weakness);\n}\n\nreturn weakness_By_Phase;\n}}}\n\n**Create a folder to hold a view per phase:**\n{{{\nforeach(var item in weakness_By_Phase)\n{\n\tvar tmView = tmFolder.add_View(item.Key);\n\tforeach(var weakness in item.Value)\n\t\ttmView.add_Article(weakness.Title,weakness.Content, weakness.Technology, item.Key, weakness.Type, weakness.Category);\n\t\t\n\tif (itemsProcessed++.mod0(30))\n\t\t\"[{0}/{1}]\".info(itemsProcessed, cweData.Weaknesses.size()); \n\t\n }\n\npanel.clear().add_WebBrowser_Control().open(tmSite); \n}}}\n\n**Complete script which creates two libraries:**\n\n{{{\n\nvar targetDir = \"_CWE_Data\".tempDir(false);\nvar mappedXml = targetDir.pathCombine(\"Cwe_data.xml\");\nvar cweData = mappedXml.load<CWE_Data>();\n\nvar tmSite = \"http://localhost.:12115\";\nvar teamMentor = new API_TEAM Mentor_WebServices(tmSite);\n\n\nteamMentor.login(\"editor\",editorPwd).str(); \n \nvar tmLibrary = teamMentor.library(\"CWE_by_Phase\").delete().library(\"CWE_by_Phase\");\n\nvar weakness_By_Phase = new Dictionary<string,List<CWE_Weakness>>();\nforeach(var weakness in cweData.Weaknesses)\n{\n\tforeach(var phase in weakness.Phase.split(\",\"))\n\t\tweakness_By_Phase.add(phase.trim(), weakness);\n}\nvar tmFolder = tmLibrary.add_Folder(\"Weakness by Phase\");\n\nvar itemsProcessed = 0;\n\nforeach(var item in weakness_By_Phase)\n{\n\tvar tmView = tmFolder.add_View(item.Key);\n\tforeach(var weakness in item.Value)\n\t\ttmView.add_Article(weakness.Title,weakness.Content, weakness.Technology, item.Key, weakness.Type, weakness.Category);\n\t\t\n\tif (itemsProcessed++.mod0(30))\n\t\t\"[{0}/{1}]\".info(itemsProcessed, cweData.Weaknesses.size()); \n\t\n }\n \n//Creating a view with all Items\ntmLibrary = teamMentor.library(\"CWE_All\").delete().library(\"CWE_All\");\nvar _tmView = tmLibrary.add_View(\"Weaknesses\");\nitemsProcessed = 0;\nforeach(var weakness in cweData.Weaknesses)\n{\n\t_tmView.add_Article(weakness.Title,weakness.Content, weakness.Technology,weakness.Phase, weakness.Type, weakness.Category);\n\tif (itemsProcessed++.mod0(30))\n\t\t\"[{0}/{1}]\".info(itemsProcessed, cweData.Weaknesses.size()); \n}\n\npanel.clear().add_WebBrowser_Control().open(tmSite); \n\n\n\nreturn \"done\";\n//using SecurityInnovation.TEAM Mentor \n//O2File:..\\TM_UnitTests\\APIs\\API_TEAM Mentor_WebServices.cs\n//O2File:CWE_Data.cs\n//O2Ref:System.Web.Services.dll\n}}}\n\n"
        ]
      }
    ]
  }
}